<%- include('partials/header.ejs'); -%>

  <div class="box" id="heading">
    <h1><%= weekTitle %></h1>
  </div>

  <div class="week-grid">
    <% for (const day of days) { %>
      <section class="day-column">
        <div class="box">
          <div class="day-heading"><h2><%= day.name %></h2></div>

          <% for (let item of day.items) { %>
            <div class="item">
              <form action="/weekly/delete" method="post">
                <input type="checkbox" onchange="this.form.submit()" name="deleteItemId" value="<%= item.id %>">
              </form>
              <p id="title<%=item.id%>">
                <%= item.title %>
                <% if (item.createdDate) { %>
                  <small class="created-date">Â· <%= item.createdDate %></small>
                <% } %>
              </p>
              <form class="edit" action="/weekly/edit" method="post">
                <input type="hidden" name="updatedItemId" value="<%= item.id %>">
                <input id="input<%=item.id%>" type="text" name="updatedItemTitle" value="<%= item.title %>" autocomplete="off" autofocus hidden>
                <button id="done<%=item.id%>" class="edit" type="submit" hidden>
                  <img class="icon" src="/assets/icons/check-solid.svg" alt="tick image">
                </button>
              </form>
              <button id="edit<%=item.id%>" class="edit" onclick="handler('<%=item.id%>')">
                <img class="icon" src="/assets/icons/pencil-solid.svg" alt="pencil image">
              </button>
            </div>
          <% } %>

          <form class="item" action="/weekly/add" method="post">
            <input type="text" name="newItem" placeholder="New Item" autocomplete="off">
            <input type="hidden" name="day" value="<%= day.day %>">
            <button class="add" type="submit">+</button>
          </form>
        </div>
      </section>
    <% } %>
  </div>

  <script>
    function handler(id) {
      document.getElementById("title" + id).setAttribute("hidden", true);
      document.getElementById("edit" + id).setAttribute("hidden", true);
      document.getElementById("done" + id).removeAttribute("hidden");
      document.getElementById("input" + id).removeAttribute("hidden");
    }
  </script>

<%- include('partials/footer.ejs'); -%>
